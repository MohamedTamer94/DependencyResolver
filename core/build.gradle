plugins {
    id 'java'
}

group 'io.mohamed.resolver'
version '0.3-alpha'
description = 'The core module to resolve dependencies for the given artifact.'

repositories {
    mavenCentral()
    flatDir {
        dirs '../libs'
    }
}

dependencies {
    implementation 'commons-io:commons-io:2.11.0'
    implementation 'org.jsoup:jsoup:1.14.2'
    implementation 'org.eclipse.jgit:org.eclipse.jgit:5.12.0.202106070339-r'
    implementation 'org.slf4j:slf4j-api:2.0.0-alpha5'
    implementation 'org.slf4j:slf4j-simple:2.0.0-alpha5'
    implementation 'com.google.guava:guava:30.1.1-jre'
    implementation name: 'common-24.3.0'
    implementation name: 'sdk-common-24.3.0'
    implementation name: 'manifest-merger-25.3.0'
    implementation name: 'layoutlib-api-24.3.0'
}

task generateSources {
    def outputDir = file("$buildDir/../src/main/java/io/mohamed/resolver/core/version")
    outputs.dir outputDir
    doFirst {
        outputDir.exists() || outputDir.mkdirs()
        def srcFile = new File(outputDir, "Version.java")
        srcFile.write(
                """// AUTOGENERATED FILE - DON'T EDIT
package io.mohamed.resolver.core.version;

public class Version {
  public static final String VERSION = "$project.version";
}
""")
    }
}
compileJava.dependsOn generateSources
compileJava.source generateSources.outputs.files, sourceSets.main.java